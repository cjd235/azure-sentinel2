{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2020-08-01",
      "name": "[concat(parameters('workspace'), '/(GWorkspaceActivityReports')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "eTag": "*",
        "displayName": "GWorkspaceActivityReports",
        "category": "Microsoft Sentinel Parser",
        "FunctionAlias": "GWorkspaceActivityReports",
        "query": "let GWorkspace_ReportsAPI_view  = view () { \nunion isfuzzy=true  GWorkspace_ReportsAPI_access_transparency_CL, GWorkspace_ReportsAPI_admin_CL,\n                    GWorkspace_ReportsAPI_calendar_CL, GWorkspace_ReportsAPI_chat_CL,\n                    GWorkspace_ReportsAPI_drive_CL, GWorkspace_ReportsAPI_gcp_CL,\n                    GWorkspace_ReportsAPI_gplus_CL, GWorkspace_ReportsAPI_groups_CL,\n                    GWorkspace_ReportsAPI_groups_enterprise_CL, GWorkspace_ReportsAPI_jamboard_CL,\n                    GWorkspace_ReportsAPI_login_CL, GWorkspace_ReportsAPI_meet_CL,\n                    GWorkspace_ReportsAPI_mobile_CL, GWorkspace_ReportsAPI_rules_CL,\n                    GWorkspace_ReportsAPI_saml_CL, GWorkspace_ReportsAPI_token_CL,\n                    GWorkspace_ReportsAPI_user_accounts_CL, GWorkspace_ReportsAPI_context_aware_access_CL,\n                    GWorkspace_ReportsAPI_chrome_CL, GWorkspace_ReportsAPI_data_studio_CL,\n                    GWorkspace_ReportsAPI_keep_CL\n| extend \n        AccountState=column_ifexists('ACCOUNT_STATE_s', ''),\n        ActorCallerType=column_ifexists('actor_callerType_s', ''),\n        ActorEmail=column_ifexists('actor_email_s', ''),\n        ActorIsCollaboratorAccount=column_ifexists('actor_is_collaborator_account_b', ''),\n        ActorKey=column_ifexists('actor_key_s', ''),\n        ActorProfileId=column_ifexists('actor_profileId_s', ''),\n        ApiKind=column_ifexists('api_kind_s', ''),\n        AppName=column_ifexists('app_name_s', ''),\n        ApplicationEdition=column_ifexists('APPLICATION_EDITION_s', ''),\n        ApplicationName=column_ifexists('APPLICATION_NAME_s', ''),\n        Billable=column_ifexists('billable_b', ''),\n        CalendarId=column_ifexists('calendar_id_s', ''),\n        ClientId=column_ifexists('client_id_s', ''),\n        ClientType=column_ifexists('client_type_s', ''),\n        DestinationFolderId=column_ifexists('destination_folder_id_s', ''),\n        DestinationFolderTitle=column_ifexists('destination_folder_title_s', ''),\n        DocId=column_ifexists('doc_id_s', ''),\n        DocTitle=column_ifexists('doc_title_s', ''),\n        DocType=column_ifexists('doc_type_s', ''),\n        DstUserUpn=column_ifexists('USER_EMAIL_s', ''),\n        DestUserUpn=column_ifexists('recipient_email_s', ''),\n        DvcGuid=column_ifexists('DEVICE_ID_g', ''),\n        DvcInterfaceGuid=column_ifexists('DEVICE_ID_s', ''),\n        DvcModelName=column_ifexists('DEVICE_MODEL_s', ''),\n        DvcModelNumber=column_ifexists('OS_VERSION_s', ''),\n        DvcType=column_ifexists('DEVICE_TYPE_s', ''),\n        Etag=column_ifexists('etag_s', ''),\n        EventCategoryType=column_ifexists('kind_s', ''),\n        EventEndTime=column_ifexists('end_time_s', ''),\n        EventGuest=column_ifexists('event_guest_s', ''),\n        EventId=column_ifexists('id_uniqueQualifier_s', ''),\n        EventMessage=column_ifexists('event_name_s', ''),\n        EventOriginalMessage=column_ifexists('events_s', ''),\n        EventProduct=\"Google Workspace Activity Reports\",\n        EventResponseStatus=column_ifexists('event_response_status_s', ''),\n        EventStartTime=column_ifexists('start_time_s', ''),\n        EventTitle=column_ifexists('event_title_s', ''),\n        EventType=column_ifexists('event_type_s', ''),\n        EventUid=column_ifexists('event_id_s', ''),\n        EventVendor=\"Google\",\n        GroupDomain=column_ifexists('ORG_UNIT_NAME_s', ''),\n        IdApplicationName=column_ifexists('id_applicationName_s', ''),\n        IosVendorId=column_ifexists('IOS_VENDOR_ID_s', ''),\n        IosVendorUID=column_ifexists('IOS_VENDOR_ID_g', ''),\n        IsSecondFactor=column_ifexists('is_second_factor_b', ''),\n        IsSuspicious=column_ifexists('is_suspicious_b', ''),\n        Kind=column_ifexists('kind_s', ''),\n        LastSyncAuditDate=column_ifexists('LAST_SYNC_AUDIT_DATE_s', ''),\n        LoginChallengeMethod=column_ifexists('login_challenge_method_s', ''),\n        LoginChallengeStatus=column_ifexists('login_challenge_status_s', ''),\n        LoginType=column_ifexists('login_type_s', ''),\n        ModuleName=column_ifexists('PRODUCT_NAME_s', ''),\n        NeqValue=column_ifexists('NEW_VALUE_s', ''),\n        Newvalue=column_ifexists('new_value_s', ''),\n        NotificationMessageId=column_ifexists('notification_message_id_s', ''),\n        NotificationMethod=column_ifexists('notification_method_s', ''),\n        NotificationType=column_ifexists('notification_type_s', ''),\n        OldEventTitle=column_ifexists('old_event_title_s', ''),\n        OldValue=column_ifexists('OLD_VALUE_s', ''),\n        Oldvalue=column_ifexists('old_value_s', ''),\n        OldVisibility=column_ifexists('old_visibility_s', ''),\n        OrganizerCalendarId=column_ifexists('organizer_calendar_id_s', ''),\n        OriginatingAppId=column_ifexists('originating_app_id_s', ''),\n        OsProperty=column_ifexists('OS_PROPERTY_s', ''),\n        Owner=column_ifexists('owner_s', ''),\n        OwnerDomain=column_ifexists('ownerDomain_s', ''),\n        OwnerIsSharedDrive=column_ifexists('owner_is_shared_drive_b', ''),\n        OwnerIsTeamDrive=column_ifexists('owner_is_team_drive_b', ''),\n        PrimaryEvent=column_ifexists('primary_event_b', ''),\n        ProcessName=column_ifexists('SETTING_NAME_s', ''),\n        RegisterPrivelege=column_ifexists('REGISTER_PRIVILEGE_s', ''),\n        ResourceId=column_ifexists('RESOURCE_ID_s', ''),\n        RoleName=column_ifexists('ROLE_NAME_s', ''),\n        Scope=column_ifexists('scope_s', ''),\n        ScopeData=column_ifexists('scope_data_s', ''),\n        SerialNumber=column_ifexists('SERIAL_NUMBER_s', ''),\n        SharedDriveId=column_ifexists('shared_drive_id_s', ''),\n        SourceFolderId=column_ifexists('source_folder_id_s', ''),\n        SourceFolderTitle=column_ifexists('source_folder_title_s', ''),\n        SrcIpAddr=column_ifexists('IPAddress', ''),\n        TargetCalendarId=column_ifexists('target_calendar_id_s', ''),\n        TargetUserDomain=column_ifexists('target_domain_s', ''),\n        TargetUserName=column_ifexists('target_user_s', ''),\n        TeamDriveId=column_ifexists('team_drive_id_s', ''),\n        UserAadid=column_ifexists('id_customerId_s', ''),\n        UserAgentOriginal=column_ifexists('user_agent_s', ''),\n        UserEmail=column_ifexists('USER_EMAIL_s', ''),\n        Visibility=column_ifexists('visibility_s', ''),\n        VisibilityChange=column_ifexists('visibility_change_s', '')\n| project \n        TimeGenerated,\n        AccountState,\n        ActorCallerType,\n        ActorEmail,\n        ActorIsCollaboratorAccount,\n        ActorKey,\n        ActorProfileId,\n        ApiKind,\n        AppName,\n        ApplicationEdition,\n        ApplicationName,\n        Billable,\n        CalendarId,\n        ClientId,\n        ClientType,\n        DestinationFolderId,\n        DestinationFolderTitle,\n        DocId,\n        DocTitle,\n        DocType,\n        DstUserUpn,\n        DestUserUpn,\n        DvcGuid,\n        DvcInterfaceGuid,\n        DvcModelName,\n        DvcModelNumber,\n        DvcType,\n        Etag,\n        EventCategoryType,\n        EventEndTime,\n        EventGuest,\n        EventId,\n        EventMessage,\n        EventOriginalMessage,\n        EventProduct,\n        EventResponseStatus,\n        EventStartTime,\n        EventTitle,\n        EventType,\n        EventUid,\n        EventVendor,\n        GroupDomain,\n        IdApplicationName,\n        IosVendorId,\n        IosVendorUID,\n        IsSecondFactor,\n        IsSuspicious,\n        Kind,\n        LastSyncAuditDate,\n        LoginChallengeMethod,\n        LoginChallengeStatus,\n        LoginType,\n        ModuleName,\n        NeqValue,\n        Newvalue,\n        NotificationMessageId,\n        NotificationMethod,\n        NotificationType,\n        OldEventTitle,\n        OldValue,\n        Oldvalue,\n        OldVisibility,\n        OrganizerCalendarId,\n        OriginatingAppId,\n        OsProperty,\n        Owner,\n        OwnerDomain,\n        OwnerIsSharedDrive,\n        OwnerIsTeamDrive,\n        PrimaryEvent,\n        ProcessName,\n        RegisterPrivelege,\n        ResourceId,\n        RoleName,\n        Scope,\n        ScopeData,\n        SerialNumber,\n        SharedDriveId,\n        SourceFolderId,\n        SourceFolderTitle,\n        SrcIpAddr,\n        TargetCalendarId,\n        TargetUserDomain,\n        TargetUserName,\n        TeamDriveId,\n        UserAadid,\n        UserAgentOriginal,\n        UserEmail,\n        Visibility,\n        VisibilityChange\n};\nGWorkspace_ReportsAPI_view\n",
        "version": 1,
        "tags": []
      }
    }
  ]
}
