{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2020-08-01",
      "name": "[concat(parameters('workspace'), '/(BitSightCompanyDetails')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "eTag": "*",
        "displayName": "BitSightCompanyDetails",
        "category": "Microsoft Sentinel Parser",
        "FunctionAlias": "BitSightCompanyDetails",
        "query": "let CompanyDetails_view  = view () {\n    Company_details_CL\n    | extend\n                EventVendor =\"BitSight\",\n                EventProduct =\"CompanyDetails\",\n                PrimaryCompanyGUID = column_ifexists('primary_company_guid_g', ''),\n                PrimaryCompanyName = column_ifexists('primary_company_name_s', ''),\n                AvailableUpgradeTypes = column_ifexists('available_upgrade_types_s', ''),\n                BulkEmailSenderStatus = column_ifexists('bulk_email_sender_status_s', ''),\n                CompanyFeatures = column_ifexists('company_features_s', ''),\n                CustomerMonitoringCount = column_ifexists('customer_monitoring_count_d', ''),\n                Description = column_ifexists('description_s', ''),\n                DisplayURL = column_ifexists('display_url_s', ''),\n                GUID = column_ifexists('guid_g', ''),\n                HasCompanyTree = column_ifexists('has_company_tree_b', ''),\n                HasPreferredContact = column_ifexists('has_preferred_contact_b', ''),\n                Hompage = column_ifexists('homepage_s', ''),\n                InSpmPortfolio = column_ifexists('in_spm_portfolio_b', ''),\n                Industry = column_ifexists('industry_s', ''),\n                IndustrySlug = column_ifexists('industry_slug_s', ''),\n                Ipv4Count = column_ifexists('ipv4_count_d', ''),\n                IsBundle = column_ifexists('is_bundle_b', ''),\n                IsCsp = column_ifexists('is_csp_b', ''),\n                IsMycompMysubsBundle = column_ifexists('is_mycomp_mysubs_bundle_b', ''),\n                IsPrimary = column_ifexists('is_primary_b', ''),\n                IsUnsampledAllowed = column_ifexists('is_unsampled_allowed_b', ''),\n                Name = column_ifexists('name_s', ''),\n                PeopleCount = column_ifexists('people_count_d', ''),\n                PermissionCanAnnotate = column_ifexists('permissions_can_annotate_b', ''),\n                PermissionCanDownloadCompanyReport = column_ifexists('permissions_can_download_company_report_b', ''),\n                PermissionCanEnableVendorAccess = column_ifexists('permissions_can_enable_vendor_access_b', ''),\n                PermissionCanViewCompanyReports = column_ifexists('permissions_can_view_company_reports_b', ''),\n                PermissionCanViewForensics = column_ifexists('permissions_can_view_forensics_b', ''),\n                PermissionCanViewInfrastructure = column_ifexists('permissions_can_view_infrastructure_b', ''),\n                PermissionCanViewIpAttributions = column_ifexists('permissions_can_view_ip_attributions_b', ''),\n                PermissionCanViewServiceProviders = column_ifexists('permissions_can_view_service_providers_b', ''),\n                PermissionsHasControl = column_ifexists('permissions_has_control_b', ''),\n                PrimaryDomain = column_ifexists('primary_domain_s', ''),\n                RatingIndustryMedian = column_ifexists('rating_industry_median_s', ''),\n                Ratings = column_ifexists('ratings_s', ''),\n                RelatedCompanies = column_ifexists('related_companies_s', ''),\n                SearchCount = column_ifexists('search_count_d', ''),\n                ServiceProvider = column_ifexists('service_provider_b', ''),\n                Shortname = column_ifexists('shortname_s', ''),\n                Sparkline = column_ifexists('sparkline_s', ''),\n                SubIndustry = column_ifexists('sub_industry_s', ''),\n                SubIndustrySlug = column_ifexists('sub_industry_slug_s', ''),\n                SubscriptionType = column_ifexists('subscription_type_s', ''),\n                SubscriptionTypeKey = column_ifexists('subscription_type_key_s', ''),\n                ComplianceClaimCertifications = column_ifexists('compliance_claim_certifications_s', ''),\n                ComplianceClaimTrustPage = column_ifexists('compliance_claim_trust_page_s', ''),\n                type = column_ifexists('type_s', '')\n    | project\n                TimeGenerated,\n\t\t\t\tEventVendor,\n                EventProduct,\n                PrimaryCompanyGUID,\n                PrimaryCompanyName,\n                AvailableUpgradeTypes,\n                BulkEmailSenderStatus,\n                CompanyFeatures,\n                CustomerMonitoringCount,\n                Description,\n                DisplayURL,\n                GUID,\n                HasCompanyTree,\n                HasPreferredContact,\n                Hompage,\n                InSpmPortfolio,\n                Industry,\n                IndustrySlug,\n                Ipv4Count,\n                IsBundle,\n                IsCsp,\n                IsMycompMysubsBundle,\n                IsPrimary,\n                IsUnsampledAllowed,\n                Name,\n                PeopleCount,\n                PermissionCanAnnotate,\n                PermissionCanDownloadCompanyReport,\n                PermissionCanEnableVendorAccess,\n                PermissionCanViewCompanyReports,\n                PermissionCanViewForensics,\n                PermissionCanViewInfrastructure,\n                PermissionCanViewIpAttributions,\n                PermissionCanViewServiceProviders,\n                PermissionsHasControl,\n                PrimaryDomain,\n                RatingIndustryMedian,\n                Ratings,\n                RelatedCompanies,\n                SearchCount,\n                ServiceProvider,\n                Shortname,\n                Sparkline,\n                SubIndustry,\n                SubIndustrySlug,\n                SubscriptionType,\n                SubscriptionTypeKey,\n                ComplianceClaimCertifications,\n                ComplianceClaimTrustPage,\n                type,\n                Type\n};\nCompanyDetails_view\n",
        "version": 1,
        "tags": []
      }
    }
  ]
}
