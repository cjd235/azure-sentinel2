{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2020-08-01",
      "name": "[concat(parameters('workspace'), '/(GCP_IAM')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "eTag": "*",
        "displayName": "GCP_IAM",
        "category": "Microsoft Sentinel Parser",
        "FunctionAlias": "GCP_IAM",
        "query": "GCP_IAM_CL\n| extend\n    payload_status_code_d=column_ifexists('payload_status_code_d', ''),\n    payload_status_message_s=column_ifexists('payload_status_message_s', ''),\n    payload_request_key_types_s=column_ifexists('payload_request_key_types_s', ''),\n    payload_serviceData_permissionDelta_removedPermissions_s=column_ifexists('payload_serviceData_permissionDelta_removedPermissions_s', ''),\n    payload_request_update_mask_paths_s=column_ifexists('payload_request_update_mask_paths_s', ''),\n    resource_labels_topic_id_s=column_ifexists('resource_labels_topic_id_s', ''),\n    payload_serviceData_policyDelta_bindingDeltas_s=column_ifexists('payload_serviceData_policyDelta_bindingDeltas_s', ''),\n    payload_request_policy_auditConfigs_s=column_ifexists('payload_request_policy_auditConfigs_s', ''),\n    payload_request_policy_etag_s=column_ifexists('payload_request_policy_etag_s', ''),\n    payload_request_policy_bindings_s=column_ifexists('payload_request_policy_bindings_s', ''),\n    payload_request_resource_s=column_ifexists('payload_request_resource_s', ''),\n    payload_response_bindings_s=column_ifexists('payload_response_bindings_s', ''),\n    payload_response_auditConfigs_s=column_ifexists('payload_response_auditConfigs_s', ''),\n    payload_request_page_size_d=column_ifexists('payload_request_page_size_d', ''),\n    payload_request_remove_deleted_service_accounts_b=column_ifexists('payload_request_remove_deleted_service_accounts_b', ''),\n    payload_request_view_d=column_ifexists('payload_request_view_d', ''),\n    payload_request_parent_s=column_ifexists('payload_request_parent_s', ''),\n    payload_request_show_deleted_b=column_ifexists('payload_request_show_deleted_b', ''),\n    resource_labels_role_name_s=column_ifexists('resource_labels_role_name_s', ''),\n    payload_serviceData__type_s=column_ifexists('payload_serviceData__type_s', ''),\n    payload_serviceData_permissionDelta_addedPermissions_s=column_ifexists('payload_serviceData_permissionDelta_addedPermissions_s', ''),\n    payload_request_role_included_permissions_s=column_ifexists('payload_request_role_included_permissions_s', ''),\n    payload_request_role_title_s=column_ifexists('payload_request_role_title_s', ''),\n    payload_request_role_description_s=column_ifexists('payload_request_role_description_s', ''),\n    payload_request_role_id_s=column_ifexists('payload_request_role_id_s', ''),\n    payload_response_group_name_s=column_ifexists('payload_response_group_name_s', ''),\n    payload_response_included_permissions_s=column_ifexists('payload_response_included_permissions_s', ''),\n    payload_response_title_s=column_ifexists('payload_response_title_s', ''),\n    payload_response_group_title_s=column_ifexists('payload_response_group_title_s', ''),\n    log_name_s=column_ifexists('log_name_s', ''),\n    insert_id_s=column_ifexists('insert_id_s', ''),\n    severity_s=column_ifexists('severity_s', ''),\n    timestamp_t=column_ifexists('timestamp_t', ''),\n    resource_type_s=column_ifexists('resource_type_s', ''),\n    resource_labels_email_id_s=column_ifexists('resource_labels_email_id_s', ''),\n    resource_labels_project_id_s=column_ifexists('resource_labels_project_id_s', ''),\n    resource_labels_unique_id_s=column_ifexists('resource_labels_unique_id_s', ''),\n    payload__type_s=column_ifexists('payload__type_s', ''),\n    payload_authenticationInfo_principalEmail_s=column_ifexists('payload_authenticationInfo_principalEmail_s', ''),\n    payload_authenticationInfo_principalSubject_s=column_ifexists('payload_authenticationInfo_principalSubject_s', ''),\n    payload_requestMetadata_callerIp_s=column_ifexists('payload_requestMetadata_callerIp_s', ''),\n    payload_requestMetadata_callerSuppliedUserAgent_s=column_ifexists('payload_requestMetadata_callerSuppliedUserAgent_s', ''),\n    payload_requestMetadata_requestAttributes_time_s=column_ifexists('payload_requestMetadata_requestAttributes_time_s', ''),\n    payload_serviceName_s=column_ifexists('payload_serviceName_s', ''),\n    payload_methodName_s=column_ifexists('payload_methodName_s', ''),\n    payload_authorizationInfo_s=column_ifexists('payload_authorizationInfo_s', ''),\n    payload_resourceName_s=column_ifexists('payload_resourceName_s', ''),\n    payload_request__type_s=column_ifexists('payload_request__type_s', ''),\n    payload_request_name_s=column_ifexists('payload_request_name_s', ''),\n    payload_request_account_id_s=column_ifexists('payload_request_account_id_s', ''),\n    payload_request_service_account_description_s=column_ifexists('payload_request_service_account_description_s', ''),\n    payload_request_service_account_display_name_s=column_ifexists('payload_request_service_account_display_name_s', ''),\n    payload_response_oauth2_client_id_s=column_ifexists('payload_response_oauth2_client_id_s', ''),\n    payload_response_name_s=column_ifexists('payload_response_name_s', ''),\n    payload_response_etag_s=column_ifexists('payload_response_etag_s', ''),\n    payload_response_unique_id_s=column_ifexists('payload_response_unique_id_s', ''),\n    payload_response_description_s=column_ifexists('payload_response_description_s', ''),\n    payload_response_project_id_s=column_ifexists('payload_response_project_id_s', ''),\n    payload_response_display_name_s=column_ifexists('payload_response_display_name_s', ''),\n    payload_response__type_s=column_ifexists('payload_response__type_s', ''),\n    payload_response_email_s=column_ifexists('payload_response_email_s', ''),\n    payload_request_private_key_type_d=column_ifexists('payload_request_private_key_type_d', ''),\n    payload_response_valid_before_time_seconds_d=column_ifexists('payload_response_valid_before_time_seconds_d', ''),\n    payload_response_valid_after_time_seconds_d=column_ifexists('payload_response_valid_after_time_seconds_d', ''),\n    payload_response_key_type_d=column_ifexists('payload_response_key_type_d', ''),\n    payload_response_key_origin_d=column_ifexists('payload_response_key_origin_d', ''),\n    payload_response_private_key_type_d=column_ifexists('payload_response_private_key_type_d', ''),\n    payload_response_key_algorithm_d=column_ifexists('payload_response_key_algorithm_d', ''),\n    resource_labels_service_s=column_ifexists('resource_labels_service_s', ''),\n    resource_labels_version_s=column_ifexists('resource_labels_version_s', ''),\n    resource_labels_location_s=column_ifexists('resource_labels_location_s', ''),\n    resource_labels_method_s=column_ifexists('resource_labels_method_s', ''),\n    payload_request_full_resource_name_s=column_ifexists('payload_request_full_resource_name_s', ''),\n    payload_request_options_requested_policy_version_d=column_ifexists('payload_request_options_requested_policy_version_d', ''),\n    payload_request_skip_visibility_check_b=column_ifexists('payload_request_skip_visibility_check_b', ''),\n    payload_request_page_token_s=column_ifexists('payload_request_page_token_s', '')\n| project-rename\n    PayloadStatusCode=payload_status_code_d,\n    PayloadStatusMessage=payload_status_message_s,\n    PayloadRequestKeyTypes=payload_request_key_types_s,\n    PayloadServicedataPermissiondeltaRemovedpermissions=payload_serviceData_permissionDelta_removedPermissions_s,\n    PayloadRequestUpdateMaskPaths=payload_request_update_mask_paths_s,\n    ResourceLabelsTopicId=resource_labels_topic_id_s,\n    PayloadServicedataPolicydeltaBindingdeltas=payload_serviceData_policyDelta_bindingDeltas_s,\n    PayloadRequestPolicyAuditconfigs=payload_request_policy_auditConfigs_s,\n    PayloadRequestPolicyEtag=payload_request_policy_etag_s,\n    PayloadRequestPolicyBindings=payload_request_policy_bindings_s,\n    PayloadRequestResource=payload_request_resource_s,\n    PayloadResponseBindings=payload_response_bindings_s,\n    PayloadResponseAuditconfigs=payload_response_auditConfigs_s,\n    PayloadRequestPageSize=payload_request_page_size_d,\n    PayloadRequestRemoveDeletedServiceAccounts=payload_request_remove_deleted_service_accounts_b,\n    PayloadRequestView=payload_request_view_d,\n    PayloadRequestParent=payload_request_parent_s,\n    PayloadRequestShowDeleted=payload_request_show_deleted_b,\n    ResourceLabelsRoleName=resource_labels_role_name_s,\n    PayloadServicedataType=payload_serviceData__type_s,\n    PayloadServicedataPermissiondeltaAddedpermissions=payload_serviceData_permissionDelta_addedPermissions_s,\n    PayloadRequestRoleIncludedPermissions=payload_request_role_included_permissions_s,\n    PayloadRequestRoleTitle=payload_request_role_title_s,\n    PayloadRequestRoleDescription=payload_request_role_description_s,\n    PayloadRequestRoleId=payload_request_role_id_s,\n    PayloadResponseGroupName=payload_response_group_name_s,\n    PayloadResponseIncludedPermissions=payload_response_included_permissions_s,\n    PayloadResponseTitle=payload_response_title_s,\n    PayloadResponseGroupTitle=payload_response_group_title_s,\n    LogName=log_name_s,\n    InsertId=insert_id_s,\n    EventSeverity=severity_s,\n    EventEndTime=timestamp_t,\n    ResourceType=resource_type_s,\n    ResourceLabelsEmailId=resource_labels_email_id_s,\n    ResourceLabelsProjectId=resource_labels_project_id_s,\n    ResourceLabelsUniqueId=resource_labels_unique_id_s,\n    PayloadType=payload__type_s,\n    PayloadAuthenticationinfoPrincipalemail=payload_authenticationInfo_principalEmail_s,\n    PayloadAuthenticationinfoPrincipalsubject=payload_authenticationInfo_principalSubject_s,\n    SrcIpAddr=payload_requestMetadata_callerIp_s,\n    HttpUserAgentOriginal=payload_requestMetadata_callerSuppliedUserAgent_s,\n    PayloadRequestmetadataRequestattributesTime=payload_requestMetadata_requestAttributes_time_s,\n    PayloadServicename=payload_serviceName_s,\n    PayloadMethodname=payload_methodName_s,\n    PayloadAuthorizationinfo=payload_authorizationInfo_s,\n    PayloadResourcename=payload_resourceName_s,\n    PayloadRequestType=payload_request__type_s,\n    PayloadRequestName=payload_request_name_s,\n    PayloadRequestAccountId=payload_request_account_id_s,\n    PayloadRequestServiceAccountDescription=payload_request_service_account_description_s,\n    PayloadRequestServiceAccountDisplayName=payload_request_service_account_display_name_s,\n    PayloadResponseOauth2ClientId=payload_response_oauth2_client_id_s,\n    PayloadResponseName=payload_response_name_s,\n    PayloadResponseEtag=payload_response_etag_s,\n    PayloadResponseUniqueId=payload_response_unique_id_s,\n    PayloadResponseDescription=payload_response_description_s,\n    PayloadResponseProjectId=payload_response_project_id_s,\n    PayloadResponseDisplayName=payload_response_display_name_s,\n    PayloadResponseType=payload_response__type_s,\n    PayloadResponseEmail=payload_response_email_s,\n    PayloadRequestPrivateKeyType=payload_request_private_key_type_d,\n    PayloadResponseValidBeforeTimeSeconds=payload_response_valid_before_time_seconds_d,\n    PayloadResponseValidAfterTimeSeconds=payload_response_valid_after_time_seconds_d,\n    PayloadResponseKeyType=payload_response_key_type_d,\n    PayloadResponseKeyOrigin=payload_response_key_origin_d,\n    PayloadResponsePrivateKeyType=payload_response_private_key_type_d,\n    PayloadResponseKeyAlgorithm=payload_response_key_algorithm_d,\n    ResourceLabelsService=resource_labels_service_s,\n    ResourceLabelsVersion=resource_labels_version_s,\n    ResourceLabelsLocation=resource_labels_location_s,\n    ResourceLabelsMethod=resource_labels_method_s,\n    PayloadRequestFullResourceName=payload_request_full_resource_name_s,\n    PayloadRequestOptionsRequestedPolicyVersion=payload_request_options_requested_policy_version_d,\n    PayloadRequestSkipVisibilityCheck=payload_request_skip_visibility_check_b,\n    PayloadRequestPageToken=payload_request_page_token_s\n",
        "version": 1,
        "tags": []
      }
    }
  ]
}
