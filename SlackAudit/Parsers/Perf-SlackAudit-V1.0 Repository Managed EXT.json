{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2020-08-01",
      "name": "[concat(parameters('workspace'), '/(SlackAudit')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "eTag": "*",
        "displayName": "SlackAudit",
        "category": "Microsoft Sentinel Parser",
        "FunctionAlias": "SlackAudit",
        "query": "let SlackAudit_view  = view () { \n    union isfuzzy=true SlackAudit_CL, SlackAuditNativePoller_CL\n    | extend \n        EventVendor=\"Slack\",\n        EventProduct=\"Slack Audit Logs\",\n\t\tDetailsMobileOnly=column_ifexists('details_mobile_only_b', ''),\n\t\tDetailsWebOnly=column_ifexists('details_web_only_b', ''),\n\t\tDetailsKickerId=column_ifexists('details_kicker_id_s', ''),\n\t\tDetailsKickerName=column_ifexists('details_kicker_name_s', ''),\n\t\tDetailsKickerEmail=column_ifexists('details_kicker_email_s', ''),\n\t\tDetailsKickerTeam=column_ifexists('details_kicker_team_s', ''),\n\t\tDetailsAppOwnerId=column_ifexists('details_app_owner_id_s', ''),\n\t\tDetailsGranularBotToken=column_ifexists('details_granular_bot_token_b', ''),\n\t\tDetailsNewScopes=column_ifexists('details_new_scopes_s', ''),\n\t\tDetailsPreviousScopes=column_ifexists('details_previous_scopes_s', ''),\n\t\tEntityUsergroupId=column_ifexists('entity_usergroup_id_s', ''),\n\t\tEntityUsergroupName=column_ifexists('entity_usergroup_name_s', ''),\n\t\tDetailsKickerType=column_ifexists('details_kicker_type_s', ''),\n\t\tDetailsKickerUserId=column_ifexists('details_kicker_user_id_s', ''),\n\t\tDetailsKickerUserName=column_ifexists('details_kicker_user_name_s', ''),\n\t\tDetailsKickerUserEmail=column_ifexists('details_kicker_user_email_s', ''),\n\t\tDetailsKickerUserTeam=column_ifexists('details_kicker_user_team_s', ''),\n\t\tDetailsInviterId=column_ifexists('details_inviter_id_s', ''),\n\t\tDetailsInviterName=column_ifexists('details_inviter_name_s', ''),\n\t\tDetailsInviterEmail=column_ifexists('details_inviter_email_s', ''),\n\t\tDetailsInviterTeam=column_ifexists('details_inviter_team_s', ''),\n\t\tDetailsInviterType=column_ifexists('details_inviter_type_s', ''),\n\t\tDetailsInviterUserId=column_ifexists('details_inviter_user_id_s', ''),\n\t\tDetailsInviterUserName=column_ifexists('details_inviter_user_name_s', ''),\n\t\tDetailsInviterUserEmail=column_ifexists('details_inviter_user_email_s', ''),\n\t\tDetailsInviterUserTeam=column_ifexists('details_inviter_user_team_s', ''),\n\t\tDetailsIsWorkflow=column_ifexists('details_is_workflow_b', ''),\n\t\tEntityAppId=column_ifexists('entity_app_id_s', ''),\n\t\tEntityAppName=column_ifexists('entity_app_name_s', ''),\n\t\tEntityAppIsDistributed=column_ifexists('entity_app_is_distributed_b', ''),\n\t\tEntityAppIsDirectoryApproved=column_ifexists('entity_app_is_directory_approved_b', ''),\n\t\tEntityAppIsWorkflowApp=column_ifexists('entity_app_is_workflow_app_b', ''),\n\t\tEntityAppScopes=column_ifexists('entity_app_scopes_s', ''),\n\t\tDetailsIsInternalIntegration=column_ifexists('details_is_internal_integration_b', ''),\n\t\tDetailsBotScopes=column_ifexists('details_bot_scopes_s', ''),\n\t\tEntityChannelId=column_ifexists('entity_channel_id_s', ''),\n\t\tEntityChannelPrivacy=column_ifexists('entity_channel_privacy_s', ''),\n\t\tEntityChannelName=column_ifexists('entity_channel_name_s', ''),\n\t\tEntityChannelIsShared=column_ifexists('entity_channel_is_shared_b', ''),\n\t\tEntityChannelIsOrgShared=column_ifexists('entity_channel_is_org_shared_b', ''),\n\t\tDetailsType=column_ifexists('details_type_s', ''),\n\t\tEntityUserId=column_ifexists('entity_user_id_s', ''),\n\t\tEntityUserName=column_ifexists('entity_user_name_s', ''),\n\t\tEntityUserEmail=column_ifexists('entity_user_email_s', ''),\n\t\tEntityUserTeam=column_ifexists('entity_user_team_s', ''),\n\t\tId=column_ifexists('id_g', ''),\n\t\tDateCreate=column_ifexists('date_create_d', ''),\n\t\tAction=column_ifexists('action_s', ''),\n\t\tActorType=column_ifexists('actor_type_s', ''),\n\t\tActorUserId=column_ifexists('actor_user_id_s', ''),\n\t\tActorUserName=column_ifexists('actor_user_name_s', ''),\n\t\tActorUserEmail=column_ifexists('actor_user_email_s', ''),\n\t\tActorUserTeam=column_ifexists('actor_user_team_s', ''),\n\t\tEntityType=column_ifexists('entity_type_s', ''),\n\t\tEntityFileId=column_ifexists('entity_file_id_s', ''),\n\t\tEntityFileName=column_ifexists('entity_file_name_s', ''),\n\t\tEntityFileFiletype=column_ifexists('entity_file_filetype_s', ''),\n\t\tEntityFileTitle=column_ifexists('entity_file_title_s', ''),\n\t\tContextLocationType=column_ifexists('context_location_type_s', ''),\n\t\tContextLocationId=column_ifexists('context_location_id_s', ''),\n\t\tContextLocationName=column_ifexists('context_location_name_s', ''),\n\t\tContextLocationDomain=column_ifexists('context_location_domain_s', ''),\n\t\tContextUA=column_ifexists('context_ua_s', ''),\n\t\tContextIpAddress=column_ifexists('context_ip_address_s', ''),\n\t\tContextSessionId=column_ifexists('context_session_id_d', ''),\n\t\tActionDescription=column_ifexists('action_description_s', ''),\n        EventId=column_ifexists('id_g', ''),\n        EventEndTime=column_ifexists('date_create_d', ''),\n        DvcAction=column_ifexists('action_s', ''),\n        SrcUserIdentity=column_ifexists('actor_user_id_s', ''),\n        SrcUserName=column_ifexists('actor_user_name_s', ''),\n        SrcUserEmail=column_ifexists('actor_user_email_s', ''),\n        UserAgentOriginal=column_ifexists('context_ua_s', ''),\n        SrcIpAddr=column_ifexists('context_ip_address_s', ''),\n        DvcActionDesc=column_ifexists('action_description_s', '')\n    | project\n        TimeGenerated, \n        EventVendor,\n        EventProduct,\n        DetailsMobileOnly,\n\t\tDetailsWebOnly,\n\t\tDetailsKickerId,\n\t\tDetailsKickerName,\n\t\tDetailsKickerEmail,\n\t\tDetailsKickerTeam,\n\t\tDetailsAppOwnerId,\n\t\tDetailsGranularBotToken,\n\t\tDetailsNewScopes,\n\t\tDetailsPreviousScopes,\n\t\tEntityUsergroupId,\n\t\tEntityUsergroupName,\n\t\tDetailsKickerType,\n\t\tDetailsKickerUserId,\n\t\tDetailsKickerUserName,\n\t\tDetailsKickerUserEmail,\n\t\tDetailsKickerUserTeam,\n\t\tDetailsInviterId,\n\t\tDetailsInviterName,\n\t\tDetailsInviterEmail,\n\t\tDetailsInviterTeam,\n\t\tDetailsInviterType,\n\t\tDetailsInviterUserId,\n\t\tDetailsInviterUserName,\n\t\tDetailsInviterUserEmail,\n\t\tDetailsInviterUserTeam,\n\t\tDetailsIsWorkflow,\n\t\tEntityAppId,\n\t\tEntityAppName,\n\t\tEntityAppIsDistributed,\n\t\tEntityAppIsDirectoryApproved,\n\t\tEntityAppIsWorkflowApp,\n\t\tEntityAppScopes,\n\t\tDetailsIsInternalIntegration,\n\t\tDetailsBotScopes,\n\t\tEntityChannelId,\n\t\tEntityChannelPrivacy,\n\t\tEntityChannelName,\n\t\tEntityChannelIsShared,\n\t\tEntityChannelIsOrgShared,\n\t\tDetailsType,\n\t\tEntityUserId,\n\t\tEntityUserName,\n\t\tEntityUserEmail,\n\t\tEntityUserTeam,\n\t\tId,\n\t\tDateCreate,\n\t\tAction,\n\t\tActorType,\n\t\tActorUserId,\n\t\tActorUserName,\n\t\tActorUserEmail,\n\t\tActorUserTeam,\n\t\tEntityType,\n\t\tEntityFileId,\n\t\tEntityFileName,\n\t\tEntityFileFiletype,\n\t\tEntityFileTitle,\n\t\tContextLocationType,\n\t\tContextLocationId,\n\t\tContextLocationName,\n\t\tContextLocationDomain,\n\t\tContextUA,\n\t\tContextIpAddress,\n\t\tContextSessionId,\n\t\tActionDescription,\n        EventId,\n        EventEndTime,\n        DvcAction,\n        SrcUserIdentity,\n        SrcUserName,\n        SrcUserEmail,\n        UserAgentOriginal,\n        SrcIpAddr,\n        DvcActionDesc\n};\nSlackAudit_view\n",
        "version": 1,
        "tags": []
      }
    }
  ]
}
