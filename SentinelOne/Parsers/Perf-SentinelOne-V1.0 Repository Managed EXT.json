{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2020-08-01",
      "name": "[concat(parameters('workspace'), '/(SentinelOne')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "eTag": "*",
        "displayName": "SentinelOne",
        "category": "Microsoft Sentinel Parser",
        "FunctionAlias": "SentinelOne",
        "query": "let SentinelOne_view  = view () { \n    SentinelOne_CL\n    | extend \n                EventVendor=\"SentinelOne\",\n                EventProduct=\"SentinelOne\",\n                AccountId=column_ifexists('accountId_s', ''),\n                AccountName=column_ifexists('accountName_s', ''),\n                ActivityType=column_ifexists('activityType_d', ''),\n                EventCreationTime=column_ifexists('createdAt_t', ''),\n                DataAccountName=column_ifexists('data_accountName_s', ''),\n                DataFullScopeDetails=column_ifexists('data_fullScopeDetails_s', ''),\n                DataScopeLevel=column_ifexists('data_scopeLevel_s', ''),\n                DataScopeName=column_ifexists('data_scopeName_s', ''),\n                DataSiteId=column_ifexists('data_siteId_d', ''),\n                DataSiteName=column_ifexists('data_siteName_s', ''),\n                SrcUserName=column_ifexists('data_username_s', ''),\n                EventId=column_ifexists('id_s', ''),\n                EventOriginalMessage=column_ifexists('primaryDescription_s', ''),\n                SiteId=column_ifexists('siteId_s', ''),\n                SiteName=column_ifexists('siteName_s', ''),\n                UpdatedAt=column_ifexists('updatedAt_t', ''),\n                UserIdentity=column_ifexists('userId_s', ''),\n                EventType=column_ifexists('event_name_s', ''),\n                DataByUser=column_ifexists('data_byUser_s', ''),\n                DataRole=column_ifexists('data_role_s', ''),\n                DataUserScope=column_ifexists('data_userScope_s', ''),\n                EventTypeDetailed=column_ifexists('description_s', ''),\n                DataSource=column_ifexists('data_source_s', ''),\n                DataExpiryDateStr=column_ifexists('data_expiryDateStr_s', ''),\n                DataExpiryTime=column_ifexists('data_expiryTime_d', ''),\n                DataNetworkquarantine=column_ifexists('data_networkquarantine_b', ''),\n                DataRuleCreationTime=column_ifexists('data_ruleCreationTime_d', ''),\n                DataRuleDescription=column_ifexists('data_ruleDescription_s', ''),\n                DataRuleExpirationMode=column_ifexists('data_ruleExpirationMode_s', ''),\n                DataRuleId=column_ifexists('data_ruleId_d', ''),\n                DataRuleName=column_ifexists('data_ruleName_s', ''),\n                DataRuleQueryDetails=column_ifexists('data_ruleQueryDetails_s', ''),\n                DataRuleQueryType=column_ifexists('data_ruleQueryType_s', ''),\n                DataRuleSeverity=column_ifexists('data_ruleSeverity_s', ''),\n                DataScopeId=column_ifexists('data_scopeId_d', ''),\n                DataStatus=column_ifexists('data_status_s', ''),\n                DataSystemUser=column_ifexists('data_systemUser_d', ''),\n                DataTreatasthreat=column_ifexists('data_treatasthreat_s', ''),\n                DataUserId=column_ifexists('data_userId_d', ''),\n                DataUserName=column_ifexists('data_userName_s', ''),\n                EventSubStatus=column_ifexists('secondaryDescription_s', ''),\n                AgentId=column_ifexists('agentId_s', ''),\n                DataComputerName=column_ifexists('data_computerName_s', ''),\n                DataExternalIp=column_ifexists('data_externalIp_s', ''),\n                DataGroupName=column_ifexists('data_groupName_s', ''),\n                DataSystem=column_ifexists('data_system_b', ''),\n                DataUuid=column_ifexists('data_uuid_g', ''),\n                GroupId=column_ifexists('groupId_s', ''),\n                GroupName=column_ifexists('groupName_s', ''),\n                DataGroup=column_ifexists('data_group_s', ''),\n                DataOptionalGroups=column_ifexists('data_optionalGroups_s', ''),\n                DataCreatedAt=column_ifexists('data_createdAt_t', ''),\n                DataDownloadUrl=column_ifexists('data_downloadUrl_s', ''),\n                DataFilePath=column_ifexists('data_filePath_s', ''),\n                DataFilename=column_ifexists('data_filename_s', ''),\n                DataUploadedFilename=column_ifexists('data_uploadedFilename_s', ''),\n                Comments=column_ifexists('comments_s', ''),\n                DataNewValue=column_ifexists('data_newValue_s', ''),\n                DataPolicyId=column_ifexists('data_policy_id_s', ''),\n                DataPolicyName=column_ifexists('data_policyName_s', ''),\n                DataNewValueb=column_ifexists('data_newValue_b', ''),\n                DataShouldReboot=column_ifexists('data_shouldReboot_b', ''),\n                DataRoleName=column_ifexists('data_roleName_s', ''),\n                DataScopeLevelName=column_ifexists('data_scopeLevelName_s', ''),\n                ActiveDirectoryComputerDistinguishedName=column_ifexists('activeDirectory_computerDistinguishedName_s', ''),\n                ActiveDirectoryComputerMemberOf=column_ifexists('activeDirectory_computerMemberOf_s', ''),\n                ActiveDirectoryLastUserDistinguishedName=column_ifexists('activeDirectory_lastUserDistinguishedName_s', ''),\n                ActiveDirectoryLastUserMemberOf=column_ifexists('activeDirectory_lastUserMemberOf_s', ''),\n                ActiveThreats=column_ifexists('activeThreats_d', ''),\n                AgentVersion=column_ifexists('agentVersion_s', ''),\n                AllowRemoteShell=column_ifexists('allowRemoteShell_b', ''),\n                AppsVulnerabilityStatus=column_ifexists('appsVulnerabilityStatus_s', ''),\n                ComputerName=column_ifexists('computerName_s', ''),\n                ConsoleMigrationStatus=column_ifexists('consoleMigrationStatus_s', ''),\n                CoreCount=column_ifexists('coreCount_d', ''),\n                CpuCount=column_ifexists('cpuCount_d', ''),\n                CpuId=column_ifexists('cpuId_s', ''),\n                SrcDvcDomain=column_ifexists('domain_s', ''),\n                EncryptedApplications=column_ifexists('encryptedApplications_b', ''),\n                ExternalId=column_ifexists('externalId_s', ''),\n                ExternalIp=column_ifexists('externalIp_s', ''),\n                FirewallEnabled=column_ifexists('firewallEnabled_b', ''),\n                GroupIp=column_ifexists('groupIp_s', ''),\n                InRemoteShellSession=column_ifexists('inRemoteShellSession_b', ''),\n                Infected=column_ifexists('infected_b', ''),\n                InstallerType=column_ifexists('installerType_s', ''),\n                IsActive=column_ifexists('isActive_b', ''),\n                IsDecommissioned=column_ifexists('isDecommissioned_b', ''),\n                IsPendingUninstall=column_ifexists('isPendingUninstall_b', ''),\n                IsUninstalled=column_ifexists('isUninstalled_b', ''),\n                IsUpToDate=column_ifexists('isUpToDate_b', ''),\n                LastActiveDate=column_ifexists('lastActiveDate_t', ''),\n                LastIpToMgmt=column_ifexists('lastIpToMgmt_s', ''),\n                LastLoggedInUserName=column_ifexists('lastLoggedInUserName_s', ''),\n                LicenseKey=column_ifexists('licenseKey_s', ''),\n                LocationEnabled=column_ifexists('locationEnabled_b', ''),\n                LocationType=column_ifexists('locationType_s', ''),\n                Locations=column_ifexists('locations_s', ''),\n                MachineType=column_ifexists('machineType_s', ''),\n                MitigationMode=column_ifexists('mitigationMode_s', ''),\n                MitigationModeSuspicious=column_ifexists('mitigationModeSuspicious_s', ''),\n                SrcDvcModelName=column_ifexists('modelName_s', ''),\n                NetworkInterfaces=column_ifexists('networkInterfaces_s', ''),\n                NetworkQuarantineEnabled=column_ifexists('networkQuarantineEnabled_b', ''),\n                NetworkStatus=column_ifexists('networkStatus_s', ''),\n                OperationalState=column_ifexists('operationalState_s', ''),\n                OsArch=column_ifexists('osArch_s', ''),\n                SrcDvcOs=column_ifexists('osName_s', ''),\n                OsRevision=column_ifexists('osRevision_s', ''),\n                OsStartTime=column_ifexists('osStartTime_t', ''),\n                OsType=column_ifexists('osType_s', ''),\n                RangerStatus=column_ifexists('rangerStatus_s', ''),\n                RangerVersion=column_ifexists('rangerVersion_s', ''),\n                RegisteredAt=column_ifexists('registeredAt_t', ''),\n                RemoteProfilingState=column_ifexists('remoteProfilingState_s', ''),\n                ScanFinishedAt=column_ifexists('scanFinishedAt_t', ''),\n                ScanStartedAt=column_ifexists('scanStartedAt_t', ''),\n                ScanStatus=column_ifexists('scanStatus_s', ''),\n                ThreatRebootRequired=column_ifexists('threatRebootRequired_b', ''),\n                TotalMemory=column_ifexists('totalMemory_d', ''),\n                UserActionsNeeded=column_ifexists('userActionsNeeded_s', ''),\n                Uuid=column_ifexists('uuid_g', ''),\n                Creator=column_ifexists('creator_s', ''),\n                CreatorId=column_ifexists('creatorId_s', ''),\n                Inherits=column_ifexists('inherits_b', ''),\n                IsDefault=column_ifexists('isDefault_b', ''),\n                Name=column_ifexists('name_s', ''),\n                RegistrationToken=column_ifexists('registrationToken_s', ''),\n                TotalAgents=column_ifexists('totalAgents_d', ''),\n                Type=column_ifexists('type_s', '')\n    | project\n                TimeGenerated, \n                EventVendor,\n                EventProduct,\n                AccountName,\n                ActivityType,\n                EventCreationTime,\n                DataAccountName,\n                DataFullScopeDetails,\n                DataScopeLevel,\n                DataScopeName,\n                DataSiteId,\n                DataSiteName,\n                SrcUserName,\n                EventId,\n                EventOriginalMessage,\n                SiteId,\n                SiteName,\n                UpdatedAt,\n                UserIdentity,\n                EventType,\n                DataByUser,\n                DataRole,\n                DataUserScope,\n                EventTypeDetailed,\n                DataSource,\n                DataExpiryDateStr,\n                DataExpiryTime,\n                DataNetworkquarantine,\n                DataRuleCreationTime,\n                DataRuleDescription,\n                DataRuleExpirationMode,\n                DataRuleId,\n                DataRuleName,\n                DataRuleQueryDetails,\n                DataRuleQueryType,\n                DataRuleSeverity,\n                DataScopeId,\n                DataStatus,\n                DataSystemUser,\n                DataTreatasthreat,\n                DataUserId,\n                DataUserName,\n                EventSubStatus,\n                AgentId,\n                DataComputerName,\n                DataExternalIp,\n                DataGroupName,\n                DataSystem,\n                DataUuid,\n                GroupId,\n                GroupName,\n                DataGroup,\n                DataOptionalGroups,\n                DataCreatedAt,\n                DataDownloadUrl,\n                DataFilePath,\n                DataFilename,\n                DataUploadedFilename,\n                Comments,\n                DataNewValue,\n                DataPolicyId,\n                DataPolicyName,\n                DataNewValueb,\n                DataShouldReboot,\n                DataRoleName,\n                DataScopeLevelName,\n                ActiveDirectoryComputerDistinguishedName,\n                ActiveDirectoryComputerMemberOf,\n                ActiveDirectoryLastUserDistinguishedName,\n                ActiveDirectoryLastUserMemberOf,\n                ActiveThreats,\n                AgentVersion,\n                AllowRemoteShell,\n                AppsVulnerabilityStatus,\n                ComputerName,\n                ConsoleMigrationStatus,\n                CoreCount,\n                CpuCount,\n                CpuId,\n                SrcDvcDomain,\n                EncryptedApplications,\n                ExternalId,\n                ExternalIp,\n                FirewallEnabled,\n                GroupIp,\n                InRemoteShellSession,\n                Infected,\n                InstallerType,\n                IsActive,\n                IsDecommissioned,\n                IsPendingUninstall,\n                IsUninstalled,\n                IsUpToDate,\n                LastActiveDate,\n                LastIpToMgmt,\n                LastLoggedInUserName,\n                LicenseKey,\n                LocationEnabled,\n                LocationType,\n                Locations,\n                MachineType,\n                MitigationMode,\n                MitigationModeSuspicious,\n                SrcDvcModelName,\n                NetworkInterfaces,\n                NetworkQuarantineEnabled,\n                NetworkStatus,\n                OperationalState,\n                OsArch,\n                SrcDvcOs,\n                OsRevision,\n                OsStartTime,\n                OsType,\n                RangerStatus,\n                RangerVersion,\n                RegisteredAt,\n                RemoteProfilingState,\n                ScanFinishedAt,\n                ScanStartedAt,\n                ScanStatus,\n                ThreatRebootRequired,\n                TotalMemory,\n                UserActionsNeeded,\n                Uuid,\n                Creator,\n                CreatorId,\n                Inherits,\n                IsDefault,\n                Name,\n                RegistrationToken,\n                TotalAgents,\n                Type\n};\nSentinelOne_view\n",
        "version": 1,
        "tags": []
      }
    }
  ]
}
