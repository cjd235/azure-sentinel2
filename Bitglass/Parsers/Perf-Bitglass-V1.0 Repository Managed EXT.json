{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workspace": {
      "type": "String"
    }
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/savedSearches",
      "apiVersion": "2020-08-01",
      "name": "[concat(parameters('workspace'), '/(Bitglass')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "eTag": "*",
        "displayName": "Bitglass",
        "category": "Microsoft Sentinel Parser",
        "FunctionAlias": "Bitglass",
        "query": "let Bitglass_view  = view () { \n    BitglassLogs_CL\n    | extend \n                EventVendor=\"Bitglass\",\n                SrcFileExtension=column_ifexists('docextension_s', ''),\n                DocType=column_ifexists('doctype_s', ''),\n                SrcFileSHA256=column_ifexists('docsha256_s', ''),\n                SrcFileSHA1=column_ifexists('docsha1_s', ''),\n                PolicyId=column_ifexists('policyid_s', ''),\n                ThreatId=column_ifexists('threatindicator_s', ''),\n                SrcFileMD5=column_ifexists('docmd5_s', ''),\n                Keyword=column_ifexists('keyword_s', ''),\n                HttpStatusCode=column_ifexists('responsecode_d', ''),\n                DvcId=column_ifexists('deviceguid_s', ''),\n                Owner=column_ifexists('owner_s', ''),\n                EventResult=column_ifexists('status_s', ''),\n                SrcFilePath=column_ifexists('folder_s', ''),\n                FileId= column_ifexists('fileid_g', column_ifexists('fileid_s', '')),\n                FileLink=column_ifexists('filelink_s', ''),\n                SharedWith=column_ifexists('sharedwith_s', ''),\n                User=column_ifexists('user_s', ''),\n                Dvc=column_ifexists('device_s', ''),\n                Application=column_ifexists('application_s', ''),\n                SrcGeoLocation=column_ifexists('location_s', ''),\n                EventMessage=column_ifexists('activity_s', ''),\n                HttpRequest=column_ifexists('request_s', ''),\n                TransactionId=column_ifexists('transactionid_s', ''),\n                EmailFrom=column_ifexists('emailfrom_s', ''),\n                EmailTo=column_ifexists('emailto_s', ''),\n                EmailSubject=column_ifexists('emailsubject_s', ''),\n                EmailCc=column_ifexists('emailcc_s', ''),\n                EmailBcc=column_ifexists('emailbcc_s', ''),\n                EmailSentTime=column_ifexists('emailsenttime_s', todatetime(emailsenttime_s)),\n                SrcFileName=column_ifexists('filename_s', ''),\n                DlpPattern=column_ifexists('dlppattern_s', ''),\n                PageTitle=column_ifexists('pagetitle_s', ''),\n                Url=column_ifexists('url_s', ''),\n                EventResultDetails=column_ifexists('details_s', ''),\n                SyslogHeader=column_ifexists('syslogheader_s', ''),\n                NetworkProtocol=column_ifexists('protocol_s', ''),\n                CustomLocation=column_ifexists('customlocation_s', ''),\n                HttpRequestMethod=column_ifexists('requestmethod_s', ''),\n                UserGroup=column_ifexists('usergroup_s', ''),\n                BgCategories=column_ifexists('bgcategories_s', ''),\n                NetworkBytes=column_ifexists('size_s', ''),\n                City=column_ifexists('city_s', ''),\n                DvcGuid=column_ifexists('deviceguid_g', ''),\n                DstIpAddr=column_ifexists('destinationip_s', ''),\n                SrcIpAddr=column_ifexists('IPAddress', ''),\n                Webreputation=column_ifexists('webreputation_s', ''),\n                SrcGeoLongitude=column_ifexists('long_s', ''),\n                DstDomain=column_ifexists('requestdomain_s', ''),\n                SeTransactionid=column_ifexists('setransactionid_g', ''),\n                Arguments=column_ifexists('arguments_s', ''),\n                IndexedTime=todatetime(indexedtime_s),\n                Email=column_ifexists('email_s', ''),\n                BgCloudScore=column_ifexists('bgcloudscore_s', ''),\n                FirstName=column_ifexists('firstname_s', ''),\n                LastName=column_ifexists('lastname_s', ''),\n                DvcHostname=column_ifexists('devicehostname_s', ''),\n                SrcGeoRegionCode=column_ifexists('regioncode_s', ''),\n                SrcGeoLatitude=column_ifexists('lat_s', ''),\n                SrcBytes=column_ifexists('uploadedbytes_s', ''),\n                WebCategories=column_ifexists('webcategories_s', ''),\n                SrcGeoCountryCode=column_ifexists('countrycode_s', ''),\n                HttpReferrer=column_ifexists('referrer_s', ''),\n                SrcGeoCountry=column_ifexists('country_s', ''),\n                SrcGeoRegion=column_ifexists('region_s', ''),\n                Uri=column_ifexists('uri_s', ''),\n                CustomCategories=column_ifexists('customcategories_s', ''),\n                EventEndTime=todatetime(time_s),\n                Action=column_ifexists('action_s', ''),\n                HttpUserAgent=column_ifexists('useragent_s', ''),\n                WebCategoryClass=column_ifexists('webcategoryclass_s', ''),\n                EventType=column_ifexists('log_type_s', '')           \n    | project\n                TimeGenerated, \n                EventVendor,\n                SrcFileExtension,\n                DocType,\n                SrcFileSHA256,\n                SrcFileSHA1,\n                PolicyId,\n                ThreatId,\n                SrcFileMD5,\n                Keyword,\n                HttpStatusCode,\n                DvcId,\n                Owner,\n                EventResult,\n                SrcFilePath,\n                FileId,\n                FileLink,\n                SharedWith,\n                User,\n                Dvc,\n                Application,\n                SrcGeoLocation,\n                EventMessage,\n                HttpRequest,\n                TransactionId,\n                EmailFrom,\n                EmailTo,\n                EmailSubject,\n                EmailCc,\n                EmailBcc,\n                EmailSentTime,\n                SrcFileName,\n                DlpPattern,\n                PageTitle,\n                Url,\n                EventResultDetails,\n                SyslogHeader,\n                NetworkProtocol,\n                CustomLocation,\n                HttpRequestMethod,\n                UserGroup,\n                BgCategories,\n                NetworkBytes,\n                City,\n                DvcGuid,\n                DstIpAddr,\n                SrcIpAddr,\n                Webreputation,\n                SrcGeoLongitude,\n                DstDomain,\n                SeTransactionid,\n                Arguments,\n                IndexedTime,\n                Email,\n                BgCloudScore,\n                FirstName,\n                LastName,\n                DvcHostname,\n                SrcGeoRegionCode,\n                SrcGeoLatitude,\n                SrcBytes,\n                WebCategories,\n                SrcGeoCountryCode,\n                HttpReferrer,\n                SrcGeoCountry,\n                SrcGeoRegion,\n                Uri,\n                CustomCategories,\n                EventEndTime,\n                Action,\n                HttpUserAgent,\n                WebCategoryClass,\n                EventType      \n};\nBitglass_view\n",
        "version": 1,
        "tags": []
      }
    }
  ]
}
